<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>memcached: cache.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css">
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.8 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>File&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>cache.h File Reference</h1><code>#include &lt;pthread.h&gt;</code><br>

<p>
<div class="dynheader">
Include dependency graph for cache.h:</div>
<div class="dynsection">
<p><center><img src="cache_8h__incl.png" border="0" usemap="#cache.h_map" alt=""></center>
</div>

<p>
<div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dynsection">
<p><center><img src="cache_8h__dep__incl.png" border="0" usemap="#cache.hdep_map" alt=""></center>
<map name="cache.hdep_map">
<area shape="rect" id="node3" href="memcached_8h.html" title="The main memcached header holding commonly used data structures and function prototypes..." alt="" coords="499,83,616,112"><area shape="rect" id="node27" href="cache_8c.html" title="cache.c" alt="" coords="640,83,715,112"><area shape="rect" id="node5" href="assoc_8c.html" title="assoc.c" alt="" coords="5,160,77,189"><area shape="rect" id="node7" href="daemon_8c.html" title="daemon.c" alt="" coords="101,160,189,189"><area shape="rect" id="node9" href="globals_8c.html" title="globals.c" alt="" coords="213,160,291,189"><area shape="rect" id="node11" href="hash_8c.html" title="hash.c" alt="" coords="315,160,379,189"><area shape="rect" id="node13" href="items_8c.html" title="items.c" alt="" coords="403,160,475,189"><area shape="rect" id="node15" href="memcached_8c.html" title="memcached.c" alt="" coords="499,160,616,189"><area shape="rect" id="node17" href="sizes_8c.html" title="sizes.c" alt="" coords="640,160,707,189"><area shape="rect" id="node19" href="slabs_8c.html" title="slabs.c" alt="" coords="731,160,797,189"><area shape="rect" id="node21" href="stats_8c.html" title="stats.c" alt="" coords="821,160,891,189"><area shape="rect" id="node23" href="thread_8c.html" title="thread.c" alt="" coords="915,160,992,189"><area shape="rect" id="node25" href="util_8c.html" title="util.c" alt="" coords="1016,160,1069,189"></map>
</div>

<p>
<a href="cache_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Classes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structcache__t.html">cache_t</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Definition of the structure to keep track of the internal details of the cache allocator.  <a href="structcache__t.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8h.html#565b39d1034d5aaccafd0e996904eebc">cache_constructor_t</a> (void *obj, void *notused1, int notused2)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Constructor used to initialize allocated objects.  <a href="#565b39d1034d5aaccafd0e996904eebc"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">typedef void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8h.html#7ac51941cc19301c6ce8b7c4a3d5dd9c">cache_destructor_t</a> (void *obj, void *notused)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor used to clean up allocated objects before they are returned to the operating system.  <a href="#7ac51941cc19301c6ce8b7c4a3d5dd9c"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="structcache__t.html">cache_t</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8h.html#631fa31e902ac58f80d0374ffed1d486">cache_create</a> (const char *name, size_t bufsize, size_t align, <a class="el" href="cache_8h.html#565b39d1034d5aaccafd0e996904eebc">cache_constructor_t</a> *constructor, <a class="el" href="cache_8h.html#7ac51941cc19301c6ce8b7c4a3d5dd9c">cache_destructor_t</a> *destructor)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create an object cache.  <a href="#631fa31e902ac58f80d0374ffed1d486"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8h.html#1eec88e66cd6bcfdc674a819aacc36e8">cache_destroy</a> (<a class="el" href="structcache__t.html">cache_t</a> *handle)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destroy an object cache.  <a href="#1eec88e66cd6bcfdc674a819aacc36e8"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8h.html#fccd2c89a0a8d9970452edbd322efa90">cache_alloc</a> (<a class="el" href="structcache__t.html">cache_t</a> *handle)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Allocate an object from the cache.  <a href="#fccd2c89a0a8d9970452edbd322efa90"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8h.html#5522ed543932808a129ed8f9167d0707">cache_free</a> (<a class="el" href="structcache__t.html">cache_t</a> *handle, void *ptr)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return an object back to the cache.  <a href="#5522ed543932808a129ed8f9167d0707"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="cache_8h.html#d4f8c8851cbc2284dc3af57ed3601b6b">cache_error</a></td></tr>

</table>
<hr><h2>Typedef Documentation</h2>
<a class="anchor" name="565b39d1034d5aaccafd0e996904eebc"></a><!-- doxytag: member="cache.h::cache_constructor_t" ref="565b39d1034d5aaccafd0e996904eebc" args="(void *obj, void *notused1, int notused2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int <a class="el" href="cache_8h.html#565b39d1034d5aaccafd0e996904eebc">cache_constructor_t</a>(void *obj, void *notused1, int notused2)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constructor used to initialize allocated objects. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>obj</em>&nbsp;</td><td>pointer to the object to initialized. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>notused1</em>&nbsp;</td><td>This parameter is currently not used. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>notused2</em>&nbsp;</td><td>This parameter is currently not used. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>you should return 0, but currently this is not checked </dd></dl>

</div>
</div><p>
<a class="anchor" name="7ac51941cc19301c6ce8b7c4a3d5dd9c"></a><!-- doxytag: member="cache.h::cache_destructor_t" ref="7ac51941cc19301c6ce8b7c4a3d5dd9c" args="(void *obj, void *notused)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void <a class="el" href="cache_8h.html#7ac51941cc19301c6ce8b7c4a3d5dd9c">cache_destructor_t</a>(void *obj, void *notused)          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destructor used to clean up allocated objects before they are returned to the operating system. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>obj</em>&nbsp;</td><td>pointer to the object to initialized. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>notused1</em>&nbsp;</td><td>This parameter is currently not used. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>notused2</em>&nbsp;</td><td>This parameter is currently not used. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>you should return 0, but currently this is not checked </dd></dl>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="fccd2c89a0a8d9970452edbd322efa90"></a><!-- doxytag: member="cache.h::cache_alloc" ref="fccd2c89a0a8d9970452edbd322efa90" args="(cache_t *handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void* cache_alloc           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&nbsp;</td>
          <td class="paramname"> <em>handle</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Allocate an object from the cache. 
<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>handle</em>&nbsp;</td><td>the handle to the object cache to allocate from </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>a pointer to an initialized object from the cache, or NULL if the allocation cannot be satisfied. </dd></dl>

</div>
</div><p>
<a class="anchor" name="631fa31e902ac58f80d0374ffed1d486"></a><!-- doxytag: member="cache.h::cache_create" ref="631fa31e902ac58f80d0374ffed1d486" args="(const char *name, size_t bufsize, size_t align, cache_constructor_t *constructor, cache_destructor_t *destructor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structcache__t.html">cache_t</a>* cache_create           </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>bufsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&nbsp;</td>
          <td class="paramname"> <em>align</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cache_8h.html#565b39d1034d5aaccafd0e996904eebc">cache_constructor_t</a> *&nbsp;</td>
          <td class="paramname"> <em>constructor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="cache_8h.html#7ac51941cc19301c6ce8b7c4a3d5dd9c">cache_destructor_t</a> *&nbsp;</td>
          <td class="paramname"> <em>destructor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Create an object cache. 
<p>
The object cache will let you allocate objects of the same size. It is fully MT safe, so you may allocate objects from multiple threads without having to do any syncrhonization in the application code.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>name</em>&nbsp;</td><td>the name of the object cache. This name may be used for debug purposes and may help you track down what kind of object you have problems with (buffer overruns, leakage etc) </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>bufsize</em>&nbsp;</td><td>the size of each object in the cache </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>align</em>&nbsp;</td><td>the alignment requirements of the objects in the cache. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>constructor</em>&nbsp;</td><td>the function to be called to initialize memory when we need to allocate more memory from the os. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>destructor</em>&nbsp;</td><td>the function to be called before we release the memory back to the os. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>a handle to an object cache if successful, NULL otherwise. </dd></dl>

</div>
</div><p>
<a class="anchor" name="1eec88e66cd6bcfdc674a819aacc36e8"></a><!-- doxytag: member="cache.h::cache_destroy" ref="1eec88e66cd6bcfdc674a819aacc36e8" args="(cache_t *handle)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cache_destroy           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&nbsp;</td>
          <td class="paramname"> <em>handle</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Destroy an object cache. 
<p>
Destroy and invalidate an object cache. You should return all buffers allocated with cache_alloc by using cache_free before calling this function. Not doing so results in undefined behavior (the buffers may or may not be invalidated)<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>handle</em>&nbsp;</td><td>the handle to the object cache to destroy. </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="5522ed543932808a129ed8f9167d0707"></a><!-- doxytag: member="cache.h::cache_free" ref="5522ed543932808a129ed8f9167d0707" args="(cache_t *handle, void *ptr)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cache_free           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcache__t.html">cache_t</a> *&nbsp;</td>
          <td class="paramname"> <em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>ptr</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Return an object back to the cache. 
<p>
The caller should return the object in an initialized state so that the object may be returned in an expected state from cache_alloc.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>handle</em>&nbsp;</td><td>handle to the object cache to return the object to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ptr</em>&nbsp;</td><td>pointer to the object to return. </td></tr>
  </table>
</dl>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="d4f8c8851cbc2284dc3af57ed3601b6b"></a><!-- doxytag: member="cache.h::cache_error" ref="d4f8c8851cbc2284dc3af57ed3601b6b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="cache_8h.html#d4f8c8851cbc2284dc3af57ed3601b6b">cache_error</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Apr 17 16:28:09 2009 for memcached by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.8 </small></address>
</body>
</html>
